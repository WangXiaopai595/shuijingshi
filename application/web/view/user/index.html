{include file="public/head" /}
		<link rel="stylesheet" type="text/css" href="__STYLE__/css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="__STYLE__/css/topbottom.css"/>
		<link rel="stylesheet" type="text/css" href="__STYLE__/css/usercenter.css" />
{include file="public/nav" /}
		<!--内容-->
<form id="FormDatda" enctype="multipart/form-data">
		<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 clearpadding usercenter margintop140">
			<div class="col-lg-2 col-md-2 col-sm-2 col-xs-2 marginleft16_67">
				<ul class="col-lg-12 clearpadding text-center userTitle">
					<li class="col-lg-12 col-md-12 col-xs-12 col-sm-12 clearpadding text-center myactive">
						<a class="myactives" href="{:url('user/index')}" target="_blank">个人信息</a>
					</li>
					<li class="col-lg-12 col-md-12 col-xs-12 col-sm-12 clearpadding text-center">
						<a class="" href="{:url('user/setting')}" target="_blank">安全设置</a>
					</li>
					<li class="col-lg-12 col-md-12 col-xs-12 col-sm-12 clearpadding text-center">
						<a class="" href="{:url('user/collection')}" target="_blank">收藏课程</a>
					</li>
				</ul>
			</div>


			<!--个人信息-->
			<div class="col-lg-6 col-md-6 col-xs-6 col-sm-6 userCount userCounts hide">
				<div class="col-lg-12 col-md-12 col-xs-12 col-sm-12 userinformation">
					<span>个人信息</span>
				</div>
				<div class="col-lg-12 col-md-12 col-xs-12 col-sm-12 text-center userpic">
					<img src="{$user.icon ?: '/static/web/img/SmallHead.png'}" class="cover" style="width: 145px;height: 145px;border-radius: 50%;">
					<span class="col-lg-12 col-md-12 col-xs-12 col-sm-12 updateIcon cover"><br /><br />更换<br />头像</span>
					<input type="file" id="img" name="icon" style="display: none;">
				</div>
				<div class="col-lg-12 col-md-12 col-xs-12 col-sm-12 username text-center">
					<span class="NewNicheng">{$user.name ?: $user.phone}</span>
					<img id="UpdateName" src="__STYLE__/img/UpdateIcon.png" width="1.5%">
				</div>
				<div class="col-lg-12 col-md-12 col-xs-12 col-sm-12 userphone text-center">
					<img src="__STYLE__/img/MyPhone.png" width="1.3%">
					<span class="user_phone">{$user.phone}</span><img id="UpdatePhone" src="__STYLE__/img/UpdateIcon.png" width="1.5%">
				</div>
				<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 text-center UpdateInformation">
					<button class="btnInformation" type="button">更新信息</button>
				</div>
			</div>
			<!--更换手机号-->
			<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 UpdatePhoneMbs hide">
				<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 UpdatePhoneMb">
					<div class="col-md-11 col-lg-11 col-xs-11 col-sm-11 height40"></div>
					<div class="col-lg-1 col-md-1 col-xs-1 col-sm-1 clearpadding quxiao text-right">
						<img id="closePhone" src="__STYLE__/img/close.png">
					</div>
					<div class="col-lg-2 col-md-2 col-xs-2 col-sm-2 clearpadding"></div>
					<div class="col-lg-10 col-md-10 col-xs-10 col-sm-10 clearpadding UpdatePhoneMbTitle">
						<span>更换手机号</span>
					</div>
					<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 height40"></div>
					<div class="col-lg-2 col-md-2 col-xs-2 col-sm-2 clearpadding"></div>
					<div class="col-lg-10 col-md-10 col-xs-10 col-sm-10 clearpadding NewphoneNum">
						<input type="text" name="phone" value="{$user.phone}" placeholder="请输入你的新号码" />
					</div>
					<!--<div class="col-md-12 col-lg-12 height20"></div>-->
					<div class="col-lg-2 col-md-2 col-xs-2 col-sm-2 clearpadding"></div>
					<!--<div class="VerificationCode col-lg-10 col-sm-10 col-md-10">-->
						<!--<input class="VerificationCodesinput" type="text" placeholder="请输入短信验证码" id="Verifications" />-->
						<!--<input type="button" value="获取验证码" onclick="sendemails()" id="getCodes" class="getCodes"/>-->
					<!--</div>-->
					<div class="col-lg-10 col-md-10 col-xs-10 col-sm-10 clearpadding btnUserCenter ">
						<input type="button" class="phone_btn" value="提交" />
					</div>
					<!--<div class="col-md-2 col-lg-2 clearpadding"></div>-->
				</div>
			</div>
			<!--修改昵称-->
			<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 UpdateNichengMbs hide">
				<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 UpdateNichengMb">
					<div class="col-md-11 col-lg-11 col-xs-11 col-sm-11 height40"></div>
					<div class="col-lg-1 col-md-1 col-xs-1 col-sm-1 clearpadding quxiao text-right">
						<img id="closeName" src="__STYLE__/img/close.png">
					</div>
					<div class="col-lg-2 col-md-2 col-xs-2 col-sm-2 clearpadding"></div>
					<div class="col-lg-10 col-md-10 col-xs-10 col-sm-10 clearpadding UpdatePhoneMbTitle">
						<span>修改昵称</span>
					</div>
					<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 height40"></div>
					<div class="col-lg-2 col-md-2 col-xs-2 col-sm-2"></div>
					<div class="col-lg-10 col-md-10col-xs-10 col-sm-10 clearpadding nicheng">
						<span class="OldNicheng">昵称:</span>
						<span class="NewNicheng">{$user.name ?: $user.phone}</span>
					</div>
					<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 height20"></div>
					<div class="col-lg-2 col-md-2 col-xs-2 col-sm-2 clearpadding"></div>
					<div class="col-lg-10 col-md-10 col-xs-10 col-sm-10 clearpadding NewphoneNum">
						<input id="newsName" type="text" name="name" value="{$user.name}" placeholder="请输入你的新昵称" />
					</div>
					<div class="col-md-2 col-lg-2 col-xs-2 col-sm-2 clearpadding"></div>
					<div class="col-lg-10 col-md-10 col-xs-10 col-sm-10 clearpadding btnUserCenter">
						<input type="button" id="updName" value="提交" />
					</div>
				</div>
			</div>
			<!--身份验证-->
			<div class="col-lg-12 col-md-12 col-xs-12 col-sm-12 IdentityVerificationMbs hide">
				<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 IdentityVerificationMb">
					<div class="col-md-11 col-lg-11 col-xs-11 col-sm-11 height40"></div>
					<div class="col-lg-1 col-md-1 col-xs-1 col-sm-1 clearpadding text-right">
						<img class="closeInformat" src="__STYLE__/img/close.png">
					</div>
					<div class="col-lg-2 col-md-2 col-xs-2 col-sm-2 clearpadding"></div>
					<div class="col-lg-10 col-md-10 col-xs-10 col-sm-10 clearpadding UpdatePhoneMbTitle">
						<span>身份验证</span>
					</div>
					<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 height40"></div>
					<div class="col-lg-2 col-md-2 col-xs-2 col-sm-2 clearpadding"></div>
					<div class="col-lg-10 col-md-10 col-xs-10 col-sm-10 clearpadding NewphoneNum">
						<span class="yzbenren">为确保是你本人操作，我们需要验证你的身份！</span><br />
						<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 height20"></div>
						<span class="yzphone">{:phoneHide($user['phone'])}</span>
					</div>
					<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 height20"></div>
					<div class="col-lg-2 col-md-2 col-xs-2 col-sm-2 clearpadding"></div>
					<div class="VerificationCode col-lg-10 col-xs-10 col-sm-10 col-md-10">
						<input class="VerificationCodesinput" name="code" type="text" placeholder="请输入短信验证码" id="Verifications" />
						<input type="button" value="获取验证码" class="getCode" id="getCode" />
					</div>
					<div class="col-lg-10 col-md-10 col-xs-10 col-sm-10 clearpadding btnUserCenter marginleft16_67">
						<input type="button" id="update" value="提交" />
					</div>
				</div>
			</div>
			<!--个人信息-->
			<div class="col-lg-6 col-md-6 col-xs-6 col-sm-6 userCount show" id="userCount">
				<div class="col-lg-12 col-md-12 col-xs-12 col-sm-12 userinformation">
					<span>个人信息</span>
				</div>
				<div class="col-lg-12 col-md-12 col-xs-12 col-sm-12 text-center userpic">
					<img id="MyHead"class="cover" src="{$user.icon ?: '/static/web/img/SmallHead.png'}" style="width: 145px;height: 145px;border-radius: 50%;">
				</div>
				<div class="col-lg-12 col-md-12 col-xs-12 col-sm-12 username text-center">
					<span class="NewNicheng">{$user.name ?: $user.phone}</span>
				</div>
				<div class="col-lg-12 col-md-12 col-xs-12 col-sm-12 userphone text-center">
					<img src="__STYLE__/img/MyPhone.png" width="1.3%">
					<span class="user_phone">{$user.phone}</span>
				</div>
				<div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 text-center UpdateInformation">
					<button class="btnInformatio" type="button">更新信息</button>
				</div>
			</div>
			<div class="col-lg-1 col-md-1 col-xs-1 col-sm-1"></div>
		</div>
</form>
{include file="public/foot" /}
	<script type="text/javascript" src="__STYLE__/js/jQuery-2.1.0.js" ></script>
	<script type="text/javascript" src="__STYLE__/js/topHover.js" ></script>
	<script type="text/javascript" src="__STYLE__/js/qrCodeAndPage.js" ></script>
	<script type="text/javascript" src="__STYLE__/js/getCode.js" ></script>
	<script type="text/javascript" src="/static/admin/js/layer.js" ></script>
	<script>
		$(function() {
			$(".cover").click(function(){
				$("#img").click();
			})
			$('#img').change(function() {
				var html = '';
				for(var i=0;i<(this.files).length;i++){
					var file = this.files[i];
					var r = new FileReader();
					r.readAsDataURL(file);
					$(r).load(function() {
						$(".cover").attr('src',this.result);
					})
				}
			})

			$('#update').click(function(){
				var data = new FormData($("#FormDatda")[0]);
				var index = layer.load(2,{time:10000});
				$.ajax({
					url: '{:url("user/update")}',
					type: 'POST',
					data: data,
					dataType:'json',
					async: true,
					cache: false,
					contentType: false,
					processData: false,
					success:function(date){
						layer.close(index);
						if(date.status == 1){
							layer.msg(date.msg,{icon:1,time:1000});
							setTimeout(function(){
								location.reload();
							},700)
						}else{
							layer.msg(date.msg,{icon:2,time:1000});
						}
					}
				});
			})

			$('.phone_btn').click(function(){
				var phone = $('input[name=phone]').val();
				re = /^1[3|4|5|7|8|9]\d{9}$/;
				if(!re.test(phone)){
					return layer.open({
						title: '提示',
						icon:0,
						content: '请输入正确的手机号'
					});
				}
				$('.user_phone').html(phone);
				$(".UpdatePhoneMbs").removeClass("show").addClass("hide");
			})

			$('.getCode').click(function(){
				$.ajax({
					type:'POST',
					dataType:'json',
					url:'{:url("user/getMsg")}',
					data:{},
					success:function(data){
						if(data.status){
							sendemail();
						}else{
							layer.open({
								title: '提示',
								icon:0,
								content: data.msg
							});
						}
					}
				});
			})

			$("#userCount").mouseenter(function() {
				$(".userCount").removeClass("show").addClass("hide").siblings(".userCounts").removeClass("hide").addClass("show");
			});
			$(".usercenter").mouseleave(function() {
				$(".userCounts").removeClass("show").addClass("hide").siblings(".userCount").removeClass("hide").addClass("show");
			});
			$("#UpdatePhone").click(function() {
				$(".UpdatePhoneMbs").removeClass("hide").addClass("show");
			});
			$("#closePhone").click(function() {
				$(".UpdatePhoneMbs").removeClass("show").addClass("hide");
			});
			$("#UpdateName").click(function() {
				$(".UpdateNichengMbs").removeClass("hide").addClass("show");
			});
			$("#closeName").click(function() {
				$(".UpdateNichengMbs").removeClass("show").addClass("hide");
			});
			$(".btnInformation").click(function(e) {
				e.stopPropagation();
				$(".IdentityVerificationMbs").removeClass("hide").addClass("show");
			});
			$(".closeInformat").click(function(e) {
				e.stopPropagation();
				$(".IdentityVerificationMbs").removeClass("show").addClass("hide");
			})
			$("#updName").click(function(){
				$(".NewNicheng").text($("#newsName").val());
				$(".UpdateNichengMbs").removeClass("show").addClass("hide");
			});
//			$('.btnInformation').click(function(){
//				$('.IdentityVerificationMbs').removeClass('hide').addClass('show');
//			});
		})
	</script>